function LookupChoice(formName,selName,editName){this.formName=formName;this.selName=selName;this.editName=editName;this.selectString='';this.selectArray=new Array();this.getElement=function(fieldName){return eval("document."+this.formName+".elements['"+fieldName+"']");};this.select=this.getElement(this.selName);this.edit=this.getElement(this.editName);this.initializeList();}LookupChoice.prototype.initializeList=function(){if(this.selectString==''){for(var i=0;i<this.select.options.length;i++){this.selectArray[i]=this.select.options[i];this.selectString+=this.select.options[i].value+":"+this.select.options[i].text;if(i<(this.select.options.length-1))this.selectString=this.selectString+",";}}else{var tempArray=this.selectString.split(',');for(var i=0;i<tempArray.length;i++){var prop=tempArray[i].split(':');this.selectArray[i]=new Option(prop[1],prop[0]);}}return;};LookupChoice.prototype.rebuildList=function(){this.initializeList();for(var i=0;i<this.selectArray.length;i++){this.select.options[i]=this.selectArray[i];}this.select.options.length=this.selectArray.length;return;};LookupChoice.prototype.updateList=function(){var j=0;var pattern=null;var str=this.edit.value.replace('^\\s*','');if(str==''){this.rebuildList();return;}this.initializeList();pattern=new RegExp("^"+str,"i");for(var i=0;i<this.selectArray.length;i++){if(pattern.test(this.selectArray[i].text)){this.select.options[j++]=this.selectArray[i];}}this.select.options.length=j;if(j==1){this.select.options[0].selected=true;}};